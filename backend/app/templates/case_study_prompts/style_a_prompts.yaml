section:
  template: |
    You are writing a section of a StyleA Business School style case study.

    SECTION: {section_title}
    DESCRIPTION: {section_description}
    WORD LIMIT: {max_words} words

    Here is relevant information from documents:

    {context}

    {previous_sections_text}

    Write the "{section_title}" section of the case study. Follow these guidelines:

    1. Use clear, engaging, and professional language suitable for business students and educators.
    2. Aim for readability — prefer short, active sentences and plain business terms instead of dense jargon or acronyms.
    3. Present facts and events objectively, but in a narrative style that helps readers understand the story and context.
    4. Where relevant, highlight cause-and-effect relationships, decisions, or turning points.
    5. Integrate key figures, numbers, and data only when they help understanding — avoid overloading the reader with information.
    6. Stay within the word limit of {max_words} words
    7. Do not make up information that is not in the provided context
    8. Format the output as clean text without headers

    SECTION CONTENT:

  input_variables:
    - section_title
    - section_description
    - max_words
    - context
    - previous_sections_text

review:
  template: |
    You are reviewing a StyleA Business School style case study for coherence, consistency and repeated information.

    CASE STUDY:
    {report}

    Please identify any issues with:
    1. Narrative flow and consistency
    2. Factual contradictions or inconsistencies
    3. Missing connections between sections
    4. Repetitive content across the sections, either using the same phrasing or conveying the same meaning

    For each issue, provide:
    - The specific issue
    - Which section(s) it affects
    - A suggested revision

    If the issue type is repetition, specify in the suggested revision exactly one single section that should contain the information and
    which sections should have repetitive content completely removed. 

    Example suggested_revision: "Detail the failed power-cut operation and its consequences fully in 'Background' section.
    In all other sections, refer to it succinctly without re-describing the event or remove them entirely.

    Format your response as JSON with this structure:
    {{
        "overall_assessment": "Brief overall assessment",
        "issues": [
            {{
                "issue_type": "flow|contradiction|missing_connection|repetition",
                "description": "Description of the issue",
                "affected_sections": ["section name(s)"],
                "suggested_revision": "Specific suggestion for revision"
            }}
        ]
    }}

    If no issues are found, return an empty issues array.

    JSON RESPONSE:

  input_variables:
    - report

revision:
  template: |
    You are revising a section of a StyleA Business School case study.

    CURRENT SECTION: {section_title}

    WORD LIMIT: {max_words} words

    CONTENT:
    {section_content}

    ISSUE TO FIX:
    {issue_description}

    SUGGESTED REVISION:
    {suggested_revision}

    Please provide a revised version of this section that addresses the issue.
    Keep within the word limit of {max_words} and ensure it maintains factual accuracy.
    Only output the revised content without any explanations or headers.
    Remove any existing word count if present.

    REVISED SECTION CONTENT:

  input_variables:
    - section_title
    - max_words
    - section_content
    - issue_description
    - suggested_revision

gap_analysis:
  template: |
    You are reviewing the following section of a StyleA Business School case study:

    SECTION TITLE: {section_title}
    SECTION CONTENT:
    {section_content}

    Identify specific information that is missing or needs enhancement:
    1. Missing facts (dates, figures, metrics)
    2. Underdeveloped points
    3. Areas needing examples or evidence

    For each gap, provide a specific search query that would help fill this gap.
    Format your response as a JSON array of objects with "gap" and "query" fields.

    Example:
    [
        {{"gap": "Revenue figures for 2022", "query": "company XYZ revenue 2022 financial data"}},
        {{"gap": "Details about the CEO's background", "query": "CEO John Smith background experience education"}}
    ]

    JSON RESPONSE:

  input_variables:
    - section_title
    - section_content

enhancement:
  template: |
    You are enhancing a section of a StyleA Business School case study.

    ORIGINAL SECTION:
    {section_content}

    ADDITIONAL INFORMATION TO INCORPORATE:
    {additional_context}

    WORD LIMIT: {max_words} words

    Rewrite the section, enhancing it with the additional information.
    Maintain the same style and structure, but fill in the gaps and make the content more complete and detailed.
    Keep within the word limit of {max_words} and ensure it maintains factual accuracy.

    ENHANCED SECTION CONTENT:

  input_variables:
    - section_content
    - max_words
    - additional_context

parallel_review:
  template: |
    You are reviewing two adjacent sections of a StyleA case study for coherence, consistency and repeated information.

    SECTIONS TO REVIEW:
    {pair_content}

    Please identify any issues with:
    1. Narrative flow and consistency
    2. Factual contradictions or inconsistencies
    3. Missing connections between sections
    4. Repetitive content across the sections, either using the same phrasing or conveying the same meaning

    For each issue, provide:
    - The specific issue
    - Which section(s) it affects
    - A suggested revision

    If the issue type is repetition, specify in the suggested revision exactly one single section that should contain the information and
    which sections should have repetitive content completely removed. 

    Example suggested_revision: "Detail the failed power-cut operation and its consequences fully in 'Background' section.
    In all other sections, refer to it succinctly without re-describing the event or remove them entirely.

    Format your response as JSON with this structure:
    {{
        "overall_assessment": "Brief overall assessment",
        "issues": [
            {{
                "issue_type": "flow|contradiction|missing_connection|repetition",
                "description": "Description of the issue",
                "affected_sections": ["{section1_title}", "{section2_title}"],
                "suggested_revision": "Specific suggestion for revision"
            }}
        ]
    }}

    If no issues are found, return an empty issues array.

    JSON RESPONSE:

  input_variables:
    - pair_content
    - section1_title
    - section2_title
